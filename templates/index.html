<!DOCTYPE html>
<html>
<head>
  <title>Notes App</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <h1>My Notes</h1>

  <input type="text" id="note-input" placeholder="Write a note...">
  <button onclick="addNote()">Add Note</button>

  <ul id="notes-list"></ul>

  <script>
    async function loadNotes() {
      const res = await fetch('/notes');
      const notes = await res.json();
      const list = document.getElementById('notes-list');
      list.innerHTML = '';
      notes.forEach(n => {
        const li = document.createElement('li');
        li.classList.add("note-item");

        const span = document.createElement('span');
        span.textContent = `${n.note} (added at ${n.timestamp})`;

        const btn = document.createElement('button');
        btn.textContent = "Delete";
        btn.classList.add("delete-btn");
        btn.onclick = () => deleteNote(n.id);

        li.appendChild(span);
        li.appendChild(btn);
        list.appendChild(li);
      });
    }

    async function addNote() {
      const note = document.getElementById('note-input').value;
      if (!note.trim()) return; // prevent empty notes
      await fetch('/notes', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({note})
      });
      document.getElementById('note-input').value = '';
      loadNotes();
    }

    async function deleteNote(id) {
      await fetch(`/notes/${id}`, { method: 'DELETE' });
      loadNotes();
    }

    loadNotes();
  </script>
</body>
</html>